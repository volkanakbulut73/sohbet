
-- 1. SİSTEM KONFİGÜRASYON TABLOSU
CREATE TABLE IF NOT EXISTS public.system_config (
    key TEXT PRIMARY KEY,
    value TEXT,
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2. VARSAYILAN DEĞERLERİ EKLE (Admin: admin / Şifre: admin123)
INSERT INTO public.system_config (key, value)
VALUES 
('bot_instruction', 'Sen Workigom platformu için özelleşmiş bir kurumsal asistansın. İş modelimize uygun profesyonel bir dil kullan.'),
('admin_username', 'admin'),
('admin_password', 'admin123')
ON CONFLICT (key) DO NOTHING;

-- 3. RLS AYARLARI
ALTER TABLE public.system_config ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Public Select Config" ON public.system_config;
CREATE POLICY "Public Select Config" ON public.system_config FOR SELECT TO public USING (true);

DROP POLICY IF EXISTS "Admin Update Config" ON public.system_config;
CREATE POLICY "Admin Update Config" ON public.system_config FOR UPDATE TO public USING (true) WITH CHECK (true);
